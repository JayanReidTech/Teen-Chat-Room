<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up or Login</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container" id="welcome-container">
        <h1>Welcome to The Teen Chat Room</h1>
        <p>Please sign up or log in to continue.</p>
        <div class="buttons">
            <button class="btn" onclick="showForm('signup')">Sign Up</button>
            <button class="btn" onclick="showForm('login')">Login</button>
        </div>
    </div>

    <div class="container" id="signup-container" style="display: none;">
        <h1>Sign Up</h1>
        <form onsubmit="return handleSignUp(event)" id="signup-form" enctype="multipart/form-data">
            <input type="file" id="profile-pic" accept="image/*">
            <p>If no profile picture is selected, a default avatar will be used.</p>
            <input type="number" id="age" placeholder="Enter Age" required min="13" max="19">
            <input type="text" id="signup-name" placeholder="Enter Name" required>
            <input type="email" id="signup-email" placeholder="Enter Email" required>
            <input type="password" id="signup-password" placeholder="Enter Password" required>
            <button type="submit">Sign Up</button>
        </form>
        <p>Already have an account? <a href="#" onclick="showForm('login')">Login</a></p>
    </div>

    <div class="container" id="login-container" style="display: none;">
        <h1>Login</h1>
        <form onsubmit="return handleLogin(event)" id="login-form">
            <input type="email" id="login-email" placeholder="Enter Email" required>
            <input type="password" id="login-password" placeholder="Enter Password" required>
            <button type="submit">Login</button>
        </form>
        <p>Don't have an account? <a href="#" onclick="showForm('signup')">Sign Up</a></p>
    </div>

    <script>
        function handleSignUp(event) {
            event.preventDefault(); // Prevent page reload
            
            let name = document.getElementById('signup-name').value;
            let email = document.getElementById('signup-email').value;
            let age = document.getElementById('age').value;
            let password = document.getElementById('signup-password').value;
            let profilePic = document.getElementById('profile-pic').files[0];
            let profilePicURL = profilePic ? URL.createObjectURL(profilePic) : 'default-avatar.png';
            
            if (name && email && password && age >= 13 && age <= 19) {
                let user = { name, email, age, password, profilePicURL };
                localStorage.setItem(email, JSON.stringify(user));
                alert('Account created successfully!');
                showForm('login');
            } else {
                alert('Please fill in all fields and ensure you are between 13 and 19 years old.');
            }
        }

        function handleLogin(event) {
            event.preventDefault(); // Prevent page reload
            
            let email = document.getElementById('login-email').value;
            let password = document.getElementById('login-password').value;
            
            let storedUser = localStorage.getItem(email);
            if (storedUser) {
                let user = JSON.parse(storedUser);
                if (user.password === password) {
                    alert('Login successful!');
                    window.location.href = 'home.html'; // Redirect to home page
                } else {
                    alert('Invalid password.');
                }
            } else {
                alert('No account found with this email. Please sign up first.');
            }
        }
        
        function showForm(formType) {
            document.getElementById('welcome-container').style.display = 'none';
            document.getElementById('signup-container').style.display = 'none';
            document.getElementById('login-container').style.display = 'none';
            
            document.getElementById(`${formType}-container`).style.display = 'block';
        }
    </script>
</body>
</html>
